#
# This is a template for a custom YOLOv3 configuration file.
#
# How to use:
# 1. Copy the original `cfg/yolov3.cfg` to `cfg/yolov3-custom.cfg`.
# 2. Modify the sections shown below according to your dataset.
#

#-------------------------------------------------
# 1. CONFIGURE THE [NET] SECTION (TOP OF THE FILE)
#-------------------------------------------------
[net]
# Testing
# batch=1
# subdivisions=1
# Training
batch=64
subdivisions=16
width=416
height=416
channels=3
momentum=0.9
decay=0.0005
angle=0
saturation = 1.5
exposure = 1.5
hue=.1

learning_rate=0.001
burn_in=1000
max_batches = 4000  # Set to (num_classes * 2000), but at least 4000
policy=steps
steps=3200,3600     # Set to 80% and 90% of max_batches
scales=.1,.1

#-------------------------------------------------
# 2. MODIFY THE [YOLO] AND PRECEDING [CONVOLUTIONAL] LAYERS
#
# You must do this for ALL THREE [yolo] layers in the file.
# The pattern is always the same. Here is the last one as an example.
# Search for "yolo" to find all three.
#-------------------------------------------------

... (previous layers) ...

# This is the convolutional layer immediately BEFORE a [yolo] layer.
[convolutional]
size=1
stride=1
pad=1
filters=21      # IMPORTANT: Set filters = (classes + 5) * 3
                # Example for 2 classes: (2 + 5) * 3 = 21
activation=linear

# This is the [yolo] detection layer itself.
[yolo]
mask = 0,1,2
anchors = 10,13,  16,30,  33,23,  30,61,  62,45,  59,119,  116,90,  156,198,  373,326
classes=2       # IMPORTANT: Set this to the number of your custom classes.
num=9
jitter=.3
ignore_thresh = .7
truth_thresh = 1
random=1        # Set to 0 for the last few hundred batches to disable multi-scale training

... (rest of the file) ...
